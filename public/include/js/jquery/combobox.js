(function(d){d.widget("custom.combobox",{options:{selectText:"",selectValue:"",remind:!1,allRemind:"All Menu",inputRemind:" Not Find",nowSelect:null,toCall:function(){}},_create:function(){this.wrapper=d("<span>").addClass("custom-combobox").insertAfter(this.element).css({position:"relative",display:"inline-block"});this.element.hide();this._createAutocomplete();this._createShowAllButton()},_createAutocomplete:function(){var b=this.element.children(":selected"),a=this.options.nowSelect,a=a?a:b.val()?
b.text():"";this.options.selectText=b.text();this.options.selectValue=b.val();var c=this;this.input=d("<input>").appendTo(this.wrapper).val(a).attr("title","").prop("id",this.element.context.id+"_combobox").addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left").autocomplete({delay:0,minLength:0,source:d.proxy(this,"_source"),select:function(b,a){c.options.selectText=a.item.label;c.options.selectValue=a.item.option.value;c.options.toCall();c.getVal()}}).tooltip({tooltipClass:"ui-state-highlight"}).css({margin:0,
padding:"5px 10px"});this._on(this.input,{autocompleteselect:function(a,b){b.item.option.selected=!0;this._trigger("select",a,{item:b.item.option})},autocompletechange:"_removeIfInvalid"})},_createShowAllButton:function(){var b=this.input,a=!1,c=this.options.allRemind;d("<a>").attr("tabIndex",-1).attr("title",c).tooltip().appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("custom-combobox-toggle ui-corner-right").mousedown(function(){a=
b.autocomplete("widget").is(":visible")}).click(function(){b.focus();if(a)return!1;b.autocomplete("search","")}).css({position:"relative",top:"-1px",bottom:0,"margin-left":"-1px",padding:"8px 0px 9px 0px"});this.options.remind||d("<a>").unbind("tooltip")},_source:function(b,a){var c=new RegExp(d.ui.autocomplete.escapeRegex(b.term),"i");a(this.element.children("option").map(function(){var a=d(this).text();if(this.value&&(!b.term||c.test(a)))return{label:a,value:a,option:this}}))},_removeIfInvalid:function(b,
a){if(!a.item){var c=this.input.val(),f=c.toLowerCase(),e=!1;this.element.children("option").each(function(){if(d(this).text().toLowerCase()===f)return this.selected=e=!0,!1});if(!e){var g=this.options.inputRemind;this.options.remind?this.input.val("").attr("title",c+g).tooltip("open"):this.input.val("");this.element.val("");this._delay(function(){this.input.tooltip("close").attr("title","")},2500);this.input.autocomplete("instance").term=""}}},getVal:function(){return{value:this.options.selectValue,
text:this.options.selectText}},_destroy:function(){this.wrapper.remove();this.element.show()}})})(jQuery);